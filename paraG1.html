<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3D Energy Collect</title>
<style>
body { margin:0; overflow:hidden; }
#score {
  position:absolute;
  top:10px;
  left:10px;
  color:white;
  font-size:20px;
}
</style>
</head>
<body>
<div id="score">Score: 0</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

<script>
let scene = new THREE.Scene();
scene.background = new THREE.Color(0x000022);

let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.z = 5;

let renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

let light = new THREE.PointLight(0xffffff, 1);
light.position.set(5,5,5);
scene.add(light);

// プレイヤー
let playerGeo = new THREE.SphereGeometry(0.3, 32, 32);
let playerMat = new THREE.MeshStandardMaterial({color:0x00ffff});
let player = new THREE.Mesh(playerGeo, playerMat);
scene.add(player);

// エネルギー
let energyGeo = new THREE.SphereGeometry(0.2, 16, 16);
let energyMat = new THREE.MeshStandardMaterial({color:0xffff00});
let energy = new THREE.Mesh(energyGeo, energyMat);
scene.add(energy);

function randomizeEnergy(){
  energy.position.x = (Math.random()-0.5)*6;
  energy.position.y = (Math.random()-0.5)*4;
}
randomizeEnergy();

let score = 0;
let speed = 0.05;

let keys = {};
document.addEventListener("keydown", e=>keys[e.key]=true);
document.addEventListener("keyup", e=>keys[e.key]=false);

function animate(){
  requestAnimationFrame(animate);

  if(keys["w"]) player.position.y += speed;
  if(keys["s"]) player.position.y -= speed;
  if(keys["a"]) player.position.x -= speed;
  if(keys["d"]) player.position.x += speed;

  // 当たり判定
  if(player.position.distanceTo(energy.position) < 0.5){
    score++;
    speed += 0.002; // だんだん速く（中毒性）
    document.getElementById("score").textContent = "Score: " + score;
    randomizeEnergy();

    // 世界の色少し変化
    scene.background.offsetHSL(0.02,0,0);
  }

  energy.rotation.y += 0.05;

  renderer.render(scene, camera);
}

animate();
</script>
</body>
</html>