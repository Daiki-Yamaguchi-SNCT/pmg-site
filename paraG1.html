<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Core Rush Bright</title>
<style>
body{
 margin:0;
 overflow:hidden;
 font-family:sans-serif;
}
#ui{
 position:absolute;
 top:15px;
 left:15px;
 color:white;
 font-size:22px;
 text-shadow:0 0 10px rgba(0,0,0,0.7);
}
</style>
</head>
<body>

<div id="ui">Score: 0</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

<script>
// ===== シーン =====
let scene = new THREE.Scene();
scene.background = new THREE.Color(0x0b2a5b);
scene.fog = new THREE.Fog(0x0b2a5b, 8, 40);

// ===== カメラ =====
let camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 100);

// ===== レンダラー =====
let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

// ===== 光（明るくする超重要ポイント）=====
let ambient = new THREE.AmbientLight(0xffffff, 0.9);
scene.add(ambient);

let light = new THREE.DirectionalLight(0xffffff, 1.2);
light.position.set(5,10,7);
scene.add(light);

// ===== プレイヤー =====
let player = new THREE.Mesh(
 new THREE.SphereGeometry(0.35,32,32),
 new THREE.MeshStandardMaterial({
  color:0x00ffff,
  emissive:0x00ffff,
  emissiveIntensity:0.8
 })
);
scene.add(player);

// ===== コア =====
let core = new THREE.Mesh(
 new THREE.IcosahedronGeometry(0.35,0),
 new THREE.MeshStandardMaterial({
  color:0xffff66,
  emissive:0xffff66,
  emissiveIntensity:1.3
 })
);
scene.add(core);

// ===== コア配置 =====
function moveCore(){
 core.position.set(
  (Math.random()-0.5)*8,
  (Math.random()-0.5)*4,
  player.position.z - 12
 );
}
moveCore();

// ===== ゲーム変数 =====
let score = 0;
let speed = 0.12;
let dirX = 0;

// ===== タップ操作（スマホ＆PC両対応）=====
function tap(e){
 let x = (e.touches ? e.touches[0].clientX : e.clientX) / innerWidth;
 dirX = (x - 0.5) * 0.35;
}
addEventListener("touchstart", tap);
addEventListener("mousedown", tap);

// ===== メインループ =====
function loop(){
 requestAnimationFrame(loop);

 // 移動
 player.position.x += dirX;
 player.position.z -= speed;

 camera.position.z = player.position.z + 6;
 camera.position.x = player.position.x;

 // コア回転
 core.rotation.x += 0.05;
 core.rotation.y += 0.05;

 // 回収判定
 if(player.position.distanceTo(core.position) < 0.7){
  score++;
  speed += 0.012; // ← 中毒ポイント（どんどん速く）
  document.getElementById("ui").textContent = "Score: " + score;

  moveCore();

  // 世界の色変化（派手演出）
  scene.background = new THREE.Color().setHSL(Math.random(), 0.6, 0.35);
 }

 renderer.render(scene, camera);
}
loop();

// ===== 画面サイズ対応 =====
addEventListener("resize", ()=>{
 camera.aspect = innerWidth/innerHeight;
 camera.updateProjectionMatrix();
 renderer.setSize(innerWidth, innerHeight);
});
</script>

</body>
</html>
